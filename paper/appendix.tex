\section{The background torque density in a three-dimensional disc with
  a fixed temperature profile}\label{tbg_deriv}
We give a brief derivation of the angular momentum exchange between
linear perturbations and the background disc. We consider a
three-dimensional disc in which the equilibrium pressure and density
are related by 
\begin{align}\label{iso_cond}
  p = c_s^2(R,z)F(\rho),
\end{align} 
where $F(\rho)$ is an arbitrary function of $\rho$ with dimensions of
mass per unit volume, and $c_s$ is a prescribed function of
position with dimensions of velocity squared. The equilibrium disc
satisfies 
\begin{align}
  R\Omega^2(R,z) &= \frac{1}{\rho}\frac{\p p}{d R} +
  \frac{\p\Phi_\mathrm{tot}}{\p R}, \\
  0 &= \frac{1}{\rho}\frac{\p p}{\p z} + \frac{\p\Phi_\mathrm{tot}}{\p
    z}. 
\end{align}
Note that, in general, the equilibrium rotation $\Omega$ depends on
$R$ and $z$. 

We begin with the linearised equation of motion in terms of the
Lagrangian displacement $\bm{\xi}$ as given by \cite{lin93b} but with an
additional potential perturbation, 
\begin{align}\label{lagragian_pert}
  &\frac{D^2\bm{\xi}}{Dt^2} +
  2\Omega\hat{\bm{z}}\times\frac{D\bm{\xi}}{Dt}  \notag \\ &= -
  \frac{\nabla \delta p }{\rho} + \frac{\delta\rho}{\rho^2}\nabla\rho  
  -\nabla\delta\Phi_d - R
  \hat{\bm{R}}\left(\bm{\xi}\cdot\nabla\Omega^2\right) \notag \\
  & = -\nabla\left(\frac{\delta p}{\rho} + \delta \Phi_d\right) -
  \frac{\delta p}{\rho}\frac{\nabla\rho}{\rho} +
  \frac{\delta\rho}{\rho}\frac{\nabla p}{\rho} -  R
  \hat{\bm{R}}\left(\bm{\xi}\cdot\nabla\Omega^2\right),
\end{align}
where $D/Dt \equiv \p_t + \ii m \Omega$ for perturbations with
azimuthal dependence in the form $\exp\left(\ii m \phi\right)$, and  
the $\delta$ quantities denote Eulerian perturbations. % Note that we
% have written the perturbed pressure force such that the state
%the associated 
%angular momentum flux (see below) has the same form as that in 
%barotropic or adiabatic discs \citep{lin93b}. 

As explained in \cite{lin11b}, a conservation law for the angular
momentum of the perturbation may be obtained by taking the dot product
between Eq. \ref{lagragian_pert} and $(-m/2)\rho\bm{\xi}^*$, then
taking the imaginary part afterwards. The left hand side becomes the
{\bf rate of change of} angular momentum density. The first term on the right hand side (RHS)
becomes 
\begin{align}\label{angflux1}
  &-\frac{m}{2}\imag\left[-\rho\bm{\xi}^*\cdot\nabla\left(\frac{\delta p}{\rho} + \delta
    \Phi_d\right)\right] \notag\\ 
&= \frac{m}{2}\imag\left\{\nabla\cdot\left[\rho\bm{\xi}^*\left(\frac{\delta p}{\rho} + \delta
    \Phi_d \right) + \frac{1}{4\pi
    G}\delta\Phi_d\nabla\delta\Phi_d^*\right]\right\} \notag\\
&+ \frac{m}{2}\imag\left(\delta\rho^*\frac{\delta p}{\rho}\right),
\end{align}
where $\delta\rho = - \nabla\cdot\left(\rho\bm{\xi}\right)$ and
$\nabla^2\delta\Phi_d = 4\pi G \delta \rho$ have been used. The 
terms in square brackets on the RHS of Eq. \ref{angflux1} is (minus) the 
angular momentum flux. The second term on RHS of Eq. \ref{angflux1}, 
together with the remaining terms on the RHS of 
Eq. \ref{lagragian_pert} constitutes the background torque. That is, 
\begin{align}\label{tbg_3d}
  T_\mathrm{BG} = \frac{m}{2}\imag\left[
    \frac{\delta p}{\rho} \Delta\rho^* -
%\left(\delta\rho^* + \bm{\xi}^*\cdot\nabla\rho\right) - 
    \frac{\delta\rho}{\rho}\bm{\xi}^*\cdot\nabla p  
    + \rho \xi_R^*\xi_z\frac{\p\left(R\Omega^2\right)}{\p z}\right],
\end{align}
where $\Delta\rho = \delta\rho + \bm{\xi}\cdot\nabla\rho$ is the
Lagrangian density perturbation. 

So far we have not invoked an energy equation. For 
adiabatic perturbations $T_\mathrm{BG}$ is zero, and we recover the
same statement of angular momentum conservation as in \cite{lin93b} but 
modified by self-gravity in the fluxes. 

However, if we impose the equilibrium relation
Eq. \ref{iso_cond} to hold in the perturbed state, then
\begin{align}
  \delta p = c_s^2(R,z) F^\prime \delta\rho,
\end{align}
where $F^\prime = dF/d\rho$. Inserting this into Eq. \ref{tbg_3d}, we
obtain
\begin{align}\label{tbg_3d_2}
  T_\mathrm{BG} = -\frac{m}{2}\frac{p}{\rho
    c_s^2}\imag\left[\delta\rho\bm{\xi}^*\cdot\nabla c_s^2 +
    \xi_R^*\xi_z \left(\frac{\p\rho}{\p z}\frac{\p c_s^2}{\p R} -
      \frac{\p\rho}{\p R}\frac{\p c_s^2}{\p z}\right)\right],
\end{align}
where the equilibrium equations were used. 
At this point setting $\xi_z=0$ gives $T_\mathrm{BG}$ for
perturbations with no vertical motion, 
\begin{align}
  T_\mathrm{BG,2D} = -\frac{m}{2}\frac{p}{\rho
    c_s^2}\imag\left(\delta\rho \xi_R^*  \p_R c_s^2 \right),
\end{align}
and is equivalent to the 2D
expression, Eq. \ref{baroclinic_torque}, with $\delta\rho $ replaced
by $\delta \Sigma$ and $p=c_s^2\rho$. % The 2D expression is convenient
% for razor-thin discs or perturbations without vertical motion because
% one can measure $\delta\rho$ (or $\delta \Sigma)$ directly.  

In fact, we can simplify Eq. \ref{tbg_3d_2} in the general case by
using $\delta\rho = - \rho\nabla\cdot\bm{\xi} -
\bm{\xi}\cdot\nabla\rho$, giving
\begin{align}\label{tbg_general}
  T_\mathrm{BG} = \frac{m}{2}\frac{p}{\rho
    c_s^2}\imag\left[\rho\left(\nabla\cdot\bm{\xi}\right)\bm{\xi}^*\cdot\nabla
  c_s^2\right].  
\end{align} 
For a barotropic fluid $p=p(\rho)$, the function $c_s^2$ can be
taken as constant (Eq. \ref{iso_cond}) for which $T_\mathrm{BG}$
vanishes. When there is a forced temperature gradient,
Eq. \ref{tbg_general} indicates a torque is applied to compressible
perturbations ($\nabla\cdot\bm{\xi}\neq0$) if there is motion along
the temperature gradient ($\bm{\xi}\cdot\nabla c_s^2 \neq 0$).   

% total effect needs to be integrated

% For the perturbations without vertical motion or those in razor-thin
% discs, the expression Eq. \ref{}

%eq baroclinic torque is more practical in 2d case because \delta
%sigma can be measured direction from simulations (xi needs to be
%calculated from velocity field, knowing the eigenfrequency)

\section{Relation between horizontal Lagrangian displacements for
  local, low frequency disturbances}\label{horizontal_displacements}
Here, we aim to relate the horizontal Lagrangian displacements $\xi_R$
and $\xi_\phi$ in the local approximation. Using the local solution to
the Poisson equation 
\begin{align}
  \delta \Phi_m = -\frac{2\pi G}{|k|} \delta\Sigma_m 
\end{align}
\citep{shu91}, the linearised azimuthal equation of motion becomes 
\begin{align} 
  - \ii\sbar \delta v_{\phi m}  + \frac{\kappa^2}{2\Omega}\delta v_{Rm} = -\frac{\ii
    m}{R\Sigma}\left(c_s^2 - \frac{2\pi G
      \Sigma}{|k|}\right)\delta\Sigma_m. 
\end{align}
Next, we replace the surface density perturbation
$\delta \Sigma_m = -\ii k \Sigma \xi_R$, and use the expressions
\begin{align}
  &\delta v_{Rm} = -\ii\sbar\xi_R,\\
  &\delta v_{\phi m} = -\ii\sbar\xi_\phi - \frac{\ii R
    \p_R\Omega}{\sbar} \delta v_{Rm}
\end{align}
\citep{papaloizou85} to obtain 
\begin{align}
  -\sbar^2\xi_\phi - 2\ii\sbar\Omega \xi_R =
  \frac{m}{kR}\left(\kappa^2 - \sbar^2\right)\xi_R, 
\end{align}
where the dispersion relation Eq. \ref{dispersion} was used. 
In the local approximation, $|kR|\gg m$ by assumption. %  Furthermore,  
% Also, for low frequency $m=1$ modes $\sbar \simeq -\Omega$, so the
% quantity $|\kappa^2 - \sbar^2| \ll \Omega^2$ in a nearly Keplerian disc
% ($\kappa\sim \Omega$). 
 Hence the RHS of this equation can be neglected. Then 
\begin{align}
  \xi_\phi \simeq -\frac{2\ii\Omega}{\sbar}\xi_R.
\end{align}
{\bf 
For low-frequency modes we have $\sbar \simeq -m\Omega$, so
$\xi_\phi\simeq 2\ii\xi_R/m$, as used in the main text.  
}




\section{The confined spiral as an external potential}\label{disc-planet}
Let us treat the one-armed spiral confined in $R\in[R_1,R_2]$ as an  
external potential of the form $\Phi_\mathrm{ext}(R)\cos{\left(\phi -
    \Omega_pt\right)}$. We take 
\begin{align} 
  \Phi_\mathrm{ext}
  =-\frac{GM_\mathrm{ring}}{\overline{R}}b^{1}_{1/2}(\beta),   
\end{align}
where $M_\mathrm{ring}$ is the disc mass contained within
$R\in[R_1,R_2]$, $\overline{R} = (R_1+R_2)/2$ is the approximate radial
location of the spiral, $b_{n}^m(\beta)$ is the Laplace coefficient
and $\beta = R/\overline{R}$. This form of
$\Phi_\mathrm{ext}$ is the $m=1$ component of the gravitational
potential of an external satellite on a circular orbit
\citep{goldreich79}.    

%For an order-of-magnitude exercise, we simply take 
%\begin{align}
 % \Phi_\mathrm{ext} = -\frac{GM_\mathrm{ring}}{|R - \overline{R}|}, 
%\end{align}
%for the potential associated with a disturbance located at
%$R=\overline{R}$, where $M_\mathrm{ring}$ 

We expect the external potential to exert a torque on the disc at the
Lindblad and co-rotation resonances. At the outer Lindblad resonance
(OLR), this torque is 
\begin{align}
  \Gamma_L =
  \frac{\pi^2\Sigma_L}{3\Omega_L\Omega_p}
  \left[\left.R_L\frac{d\Phi_\mathrm{ext}}{dR}\right|_L + 2\left(1 -
      \frac{\Omega_p}{\Omega_L}\right)\Phi_\mathrm{ext}\right]^2, 
\end{align}   
where a Keplerian disc has been assumed and subscript $L$ denotes
evaluation at the OLR, $R=R_L$. (The inner Lindblad resonance does not
exist for the pattern speeds observed in our simulations.) 

If we associate the external potential with {\bf an} angular momentum {\bf magnitude of} 
$J_\mathrm{ext}  = M_\mathrm{ring}\overline{R}^2\Omega_p$, we can
calculate a rate {\bf of change of angular momentum} $\gamma_L=\Gamma_L/J_\mathrm{ext}$. Then  
\begin{align}
  \frac{\gamma_L}{\Omega_p} = &\frac{\pi
    h}{3Q_L}\left(\frac{M_p}{M_*}\right)\left(\frac{R_L}{\overline{R}}\right)\left(\frac{R_c}{\overline{R}}\right) 
  ^3\left(\frac{R_L}{R_c}\right)^{-3/2}\notag\\ 
  &\times
  \left\{\frac{R_L}{\overline{R}}\left.\frac{db_{1/2}^1}{d\beta}\right|_L
    + 2\left[1 - 
      \left(\frac{R_c}{R_L}\right)^{-3/2}\right]b_{1/2}^1(\beta_L)\right\}^2. 
\end{align}
%\begin{align}
 % \frac{\gamma_L}{\Omega_p} \sim &\frac{\pi h}{3
  %  Q_L}\left(\frac{M_\mathrm{ring}}{M_*}\right)\left(\frac{R_L}{\overline{R}}\right)^{-1/2}\left(\frac{R_c}{\overline{R}}\right)^{5/2}\notag\\
 % &\times \left\{ \frac{R_L}{R_L - \overline{R}} - 2\left[1 -
  %    \left(\frac{R_c}{R_L}\right)^{-3/2}\right]\right\}^2\frac{R_c^2}{\left(R_L
   % - \overline{R}\right)^2}. 
%\end{align}
Inserting $h=0.05$, $Q_L=10$, $M_\mathrm{ring} = 0.05M_*$,
$R_L=7.2R_0$, $R_c=4.4R_0$ and $\overline{R}=1.5R_0$ from our fiducial
FARGO simulation, we get
\begin{align}
  \gamma_L \sim 5\times10^{-4}\Omega_p. 
\end{align}
%\begin{align}
 % \gamma_L \sim 0.012\Omega_p. 
%\end{align}
%This represents an upper limit on the effect of the OLR on the spiral
%disturbance, and is much smaller than the growth rate measured in the
%simulation ($\gamma\sim0.1\Omega_p$). We conclude that for our models,
%the OLR has negligible effect on the one-armed spiral.  
For the co-rotation torque, we use the result
\begin{align}
  \Gamma_c = \left.
    \pi^2\Phi_\mathrm{ext}^2\left(\frac{d\Omega}{dR}\right)^{-1}\frac{d}{dR}\left(\frac{2\Sigma}{\Omega}\right)\right|_{c}     
\end{align}
for a Keplerian disc, where subscript $c$ denotes evaluation at
co-rotation radius $R=R_c$. For a power-law surface density profile
$\Sigma\propto R^{-s}$ we have
\begin{align}
\frac{\gamma_c}{\Omega_p} = \frac{4}{3}\frac{\pi h}{Q_c}
\left(\frac{M_\mathrm{ring}}{M_*}\right)\left(\frac{R_c}{\overline{R}}\right)^4\left(s-\frac{3}{2}\right) 
\left[b_{1/2}^1(\beta_c)\right]^2    
\end{align}
%\begin{align}
%  \frac{\Gamma_C}{J_\mathrm{ext}\Omega_p} = \frac{4}{3}\frac{\pi h}{Q_C} \left(s -
 %   \frac{3}{2}\right)\left(\frac{M_\mathrm{ring}}{M_*}\right)\frac{R_c^4}{\overline{R}^2\left(R_c
 %     - \overline{R}\right)^2}.   
%\end{align}
Using the above parameter values with $s=2$ and $Q_c=10$, we obtain a
rate
\begin{align}
  \gamma_c\sim 6\times 10^{-4}\Omega_p. 
\end{align}

The torque exerted on the disc at the OLR by an external potential is
positive, while that at co-rotation depends 
on the gradient of potential vorticity there \citep{goldreich79}. For
our disc models with surface density $\Sigma\propto R^{-2}$ in the
outer disc, this co-rotation torque is positive. 
This means that the one-armed spiral loses
angular momentum by launching density waves with positive angular
momentum at the OLR, and by applying a 
positive co-rotation torque on the disc. In principle, this
interaction is destabilising because the one-armed spiral has 
negative angular momentum \citep{lin11b}. 

{\bf However, the above estimates for $\gamma_L$ and $\gamma_c$} are much smaller than that due to the 
imposed temperature gradient as measured in the simulations 
($\gamma\sim∼0.1\Omega_p$). We conclude that for our disc models, 
the Lindblad and co-rotation resonances have negligible effects
on the growth of the one-armed spiral in the inner disc (but it could be {\bf important} 
in other parameter regimes).  
