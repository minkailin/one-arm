\section{Discussion}\label{discussions} 
Having confirmed the $m=1$ spiral instability through numerical
simulations, we now use results from the simulations combined with
linear theory to construct an explanation for their growth. For
simplicity, we return to 2D discs. 

The dominant disturbance in our simulations is an one-armed, $m=1$
trailing spiral, and its growth is associated with the imposed temperature
gradient. As discussed in \S\ref{global_cons}, in a locally isothermal disc this imposed
temperature gradient generally results in a torque being exerted on
linear perturbations. An instability is therefore possible if the sign
of this torque is the same as that of the angular momentum associated
with the linear perturbation. 

%associated angular mometum density is the same as that
%of this
% According to previous studies \citep{adams89}, our disc models
% should not support $m=1$ linear spiral instabilities. This is because
% our discs are not sufficiently massive ($M_d\lesssim 0.1M_*$) and, more
% importantly, we have surpressed the motion of the central star. The 
% latter can induce $m=1$ instabilities in massive discs  \citep{shu90}.   

\subsection{Angular momentum density of  low-frequency $m=1$ modes}
From Eq. \ref{lin_ang_mom_cons} and assuming a time-dependence of the
form $\exp{(-\ii \sigma t)}$ with $\real{\sigma} = \omega$,  
the angular momentum density associated with linear waves is
\begin{align}
  \jlin = \frac{m\Sigma}{2}\left[\left(\omega -
      m\Omega\right)|\bm{\xi}|^2 + \ii\Omega\left(\xi_R\xi_\phi^* -
      \xi_R^*\xi_\phi\right)\right].  
\end{align}
For a low-frequency mode, $|\omega|\ll m\Omega$. Then neglecting the
term $\omega|\bm{\xi}|^2$ and setting $m=1$,
\begin{align}
  \jlin &\simeq \frac{\Sigma\Omega}{2}\left[-|\bm{\xi}|^2 + \ii\left(\xi_R\xi_\phi^* -
      \xi_R^*\xi_\phi\right)\right]\notag\\
  & = -\frac{\Sigma\Omega}{2}|\xi_R + \ii\xi_\phi|^2\notag\\
  & \leq 0.
\end{align}
Thus, low-frequency $m=1$ modes generally have negative
angular momentum. If the mode loses (positive) angular momentum 
to the background, then we can expect instability. We demonstrate
below how this is possible through a forced temperature
gradient. 

\subsection{Unstable interaction between low-frequency $m=1$ spirals 
  and the background disc due to an imposed temperature gradient}
The $m=1$ spiral that emerges in our simulations have low frequency
($\Omega_p < \Omega$),
grows slowly ($\gamma\ll\Omega_p$), and its spatial form is consistent local theory  
(\S\ref{fargo_m1}). Then to a first approximation, we can regard it 
as a neutral, low-frequency $m=1$ mode in satisfying the 
dispersion relation Eq. \ref{dispersion} in local theory.  %attribute
                                %growth to temp gradient 
To demonstrate possible instability, %we 
% first construct a neutral low-frequency mode using local theory, 
we show that the torque density acting on such a mode due to the background
temperature gradient is negative, which enforces the mode, because it
has negative angular momentum.  
% Note that
% we will not be assuming a self-gravitating disc until the end of this
% section. 

We begin by recalling the expression for the torque density due to a
locally isothermal equation of state,
\begin{align*}
  T_\mathrm{BG} = - \frac{m}{2}\frac{dc_s^2}{dR}\imag\left(\delta\Sigma_m\xi_R^*\right).   
\end{align*}
The Eulerian surface density perturbation is given by
\begin{align}\label{den_pert}
  \delta\Sigma_m = -\nabla\cdot\left(\Sigma\bm{\xi}\right) 
  = -\frac{1}{R}\frac{d}{dR}\left(R\Sigma \xi_R\right) - \frac{\ii m}{R}\Sigma\xi_\phi.  
\end{align}
We now invoke local theory by setting $d/dR \to \ii k$ where $k$ is
real, and assume $|kR|\gg m$ so that the second term on the right hand
side of Eq. \ref{den_pert} can be neglected. Then    
\begin{align}
  \delta\Sigma _m  \simeq -\ii k \Sigma \xi_R,
\end{align}
which gives
\begin{align}
  T_\mathrm{BG} = \frac{m}{2}\frac{dc_s^2}{dR}k\Sigma |\xi_R|^2. 
\end{align}
% \begin{align}
%   T_\mathrm{BG} &= -\frac{m}{2}\frac{dc_s^2}{dR}\imag\left[\delta\Sigma_m \left(\frac{\delta
%         v_{Rm}}{-\ii\sbar}\right)^*\right] \notag\\
%   & = \frac{m}{2}\frac{dc_s^2}{dR}\imag\left[\ii \delta\Sigma_m \left(\frac{\delta
%         v_{Rm}}{\sbar}\right)^*\right]
% \end{align}
% where we replaced the radial Lagrangian displacement by the Eulerian
% radial velocity perturbation in Eq. \ref{baroclinic_torque}. 
% The linearised momentum equations give
% \begin{align}
%   D\delta v_{Rm} =& 
%   \ii\sbar\left[c_s^2\frac{d}{dR}\left(\frac{\delta\Sigma_m}{\Sigma}\right)
%     + \frac{d}{dR}\delta\Phi_m\right] \notag\\ 
%   &- \frac{2\ii
%     m\Omega}{R}\left(c_s^2\frac{\delta\Sigma_m}{\Sigma} +
%     \delta\Phi_m\right),
% \end{align}
% where $D\equiv \kappa^2 - \sbar^2$. 
% We now invoke local theory by setting $d/dR \to \ii k$ where $k$ is
% real, and using the local solution to the Poisson equation
% \begin{align}
%   \delta\Phi_m = -\frac{2\pi G}{|k|}\delta\Sigma_m 
% \end{align}
% \citep{shu91}. Then the radial velocity perturbation becomes
% \begin{align}
%   \delta v_{Rm} =
%   \frac{1}{D}\frac{\delta\Sigma_m}{\Sigma}\left(\frac{2\pi G
%       \Sigma}{|k|} - c_s^2\right)\left(k\sbar + \frac{2\ii
%       m\Omega}{R}\right),
% \end{align}
% so that 
% \begin{align}
%   \ii\delta\Sigma_m \left(\frac{\delta v_{Rm}}{\sbar}\right)^* =
%   \frac{1}{D^*}\frac{|\delta\Sigma_m|^2}{\Sigma}\left(\frac{2\pi G
%       \Sigma}{|k|} - c_s^2\right)\left(\ii k  + \frac{2
%       m\Omega}{R\sbar^*}\right). 
% \end{align}
% For a neutral mode, $\sbar$, and therefore $D$ is real. Then, after
% taking the imaginary part of the above expression, the torque
% density is 
% \begin{align}\label{tbg_explicit}
%   T_\mathrm{BG} &=
%   \frac{m}{2}\frac{dc_s^2}{dR}\left[\frac{k}{D}\frac{|\delta\Sigma_m|^2}{\Sigma}\left(\frac{2\pi G
%       \Sigma}{|k|} - c_s^2\right)\right].
% % &\simeq \frac{m}{2}\frac{dc_s^2}{dR}\left[\frac{k}{\left(\kappa^2 -
% %         m^2\Omega^2\right)}\frac{|\delta\Sigma_m|^2}{\Sigma}\left(\frac{2\pi
% %       G \Sigma}{|k|} - c_s^2\right)\right]. 
% \end{align}
% We now use the local dispersion relation,
% Eq. \ref{dispersion}, to make the replacement $D = 2\pi G \Sigma |k| -
% k^2c_s^2$ in the above expression. This gives
% \begin{align}\label{tbg_simple}
%   T_\mathrm{BG} =
%   \frac{m}{2}\frac{dc_s^2}{dR}\frac{1}{k}\frac{|\delta\Sigma_m|^2}{\Sigma}.  
% \end{align}  
This torque density is negative for trailing waves in discs with
a fixed temperature profile decreasing outwards ($k>0$ and $dc_s^2/dR<0$,
respectively). Note that this conclusion does not rely on the
low-frequency approximation and holds for any $m$.   

However, if the linear disturbance under consideration \emph{is} a
low-frequency $m=1$ mode, then it has negative angular
momentum. If it is a trailing spiral and $dc_s^2/dR<0$, as is typical
for circumstellar or protoplanetary discs, then $T_\mathrm{BG}<0$, and
the background disc applies a negative torque on the disturbance,
which further decreases its angular momentum. This suggests the spiral
amplitude will grow.    

Using $\jlin$ and $T_\mathrm{BG}$, we can estimate 
the growth rate $\gamma$ of linear perturbations due to the background
torque as  
\begin{align}
  2\gamma \sim \frac{T_\mathrm{BG}}{\jlin},
\end{align}
where the factor of two accounts for the fact that the angular momentum
density is quadratic in the linear perturbations. Inserting the above
expressions for $\jlin$ and $T_\mathrm{BG}$ for $m=1$ gives
\begin{align}
  2\gamma \sim
  -\frac{dc_s^2}{dR}\frac{k}{\Omega}\frac{|\xi_R|^2}{|\xi_R + \ii
    \xi_\phi|^2}. 
%  \lesssim -\frac{dc_s^2}{dR}\frac{k}{\Omega}.
\end{align}
In Appendix \ref{horizontal_displacements}, we argue $\xi_\phi \simeq
2\ii \xi_R$ for the modes of interest. Then 
%To further simplify this expression, we need to relate $\xi_R$ and
%$\xi_\phi$. 
% \begin{align}
%   2\gamma \sim
%   -\frac{dc_s^2}{dR}\frac{1}{k\Sigma^2\Omega}\frac{|\delta\Sigma_1|^2}{|\xi_R
%     + \ii\xi_\phi|^2}.
% \end{align}
% Now, using $\delta\Sigma_m/\Sigma = -\ii k \xi_R - \ii m \xi_\phi/R$
% in the local approximation, we have
% \begin{align}
%   2\gamma \sim -\frac{dc_s^2}{dR}\frac{k}{\Omega}\frac{|\xi_R +
%     \xi_\phi/kR|^2}{|\xi_R + \ii \xi_\phi|^2}
%   \lesssim -\frac{dc_s^2}{dR}\frac{k}{\Omega}.
% \end{align}
% where we used $dc_s^2/dR <0$, $k>0$ and $|kR|\gg 1$ to obtain the
% inequality. 
%where we used $dc_s^2/dR <0$ and $k>0$ to obtain the inequality. 
for the temperature profiles $c_s^2 = c_{s0}^2 (R/R_0)^{-q}$ as
adopted in our disc models,  
\begin{align}
  2\gamma \sim q\frac{c_s^2}{R}\frac{k}{\Omega}. 
\end{align}
For perturbations in a self-gravitating disc with characteristic
wavenumber $k \sim \pi G \Sigma/c_s^2 \sim \Omega/Q c_s$, as seen in
our simulations, we have 
\begin{align}\label{theoretical_rate}
  \gamma \sim \frac{qh}{2Q}\Omega,
\end{align}
where we used $c_s/R\sim h\Omega$. For our fiducial disc models with
$q=1$, $Q=O(1)$, $h=0.05$, this gives $\gamma/\Omega \sim O(10^{-2})$,
consistent with simulation results. Specifically,
Eq. \ref{theoretical_rate} indicates the growth rate should increase
linearly with $q$ and $h$, as seen in the simulations
(Fig. \ref{fargo_varq_growth}---\ref{fargo_varh_growth}).    


%Note that changing $q$ affects the magntiude of the background
%torque through its explicit depdence on the temperature gradient. By
%definition, the global temperature gradient does not affect modes in
%local theory. 
%however, changing $h$ may also modify the mode properties (since
%temperature appears in local theory) in addition
%to the magnitude of the temperature gradient. Thus, we expect the depedence of
%the background torque on $q$ to be better described by
%Eq. \{theoretical_rate} 

%by definition, q does not affect local neutral modes
%Of course, we assumed a neutral mode to obtain expressions
%for $\jlin$ and $T_\mathrm{BG}$ in the first place, 
%Recall that in local theory non-axisymmetric modes are stable for real
%$k$  
%Eq. \ref{theoretical_rate} should be interpreted
%as an order-of-magnitude estimate of the perturbative effect of a
%temperature gradient on local, low-frequency $m=1$ modes.  

%neutral modes are not actually neutral)
%gamma << omega_p << omega 
%so
%Eq. \ref{theoretical_rate} is only an order-of-magnitude
%constraint. Nevertheless, the expected growth rate is in reasonable
%agreement with numerical results. 

%also total torque is integral -> may get cancelations 

\subsection{The role of self-gravity and disc structure} 
It is important to note that in the above discussion, we only considered a self-gravitating
perturbation to obtain an appropriate wavenumber $k$ needed to
evaluate Eq. \ref{theoretical_rate}. 
The background torque density $T_\mathrm{BG}$ does not depend on  
self-gravity explicitly, so self-gravity is not directly
responsible for instability. 

However, 
our numerical simulations show that the $m=1$ spiral is
confined between two $Q$-barriers, where real solutions to the local
dispersion relation is possible (Eq. \ref{wavenumber}), as a result of the adopted disc
structure. Thus, in our disc models the main role of disc structure and self-gravity is to 
allow a neutral mode to be set up and confined, which is then
destabilised through the background torque density. 

In order to confine an $m=1$ spiral between two $Q$-barriers, we
should have $Q^2(1-\nu^2)=1$ at two radii. Assuming 
Keplerian rotation and a slow pattern speed $\Omega_p\ll\Omega$, this amounts to
\begin{align}
  \left(\frac{R_{Qb}}{R_c}\right)^{-3/2} = 2Q^2(R_{Qb}). 
\end{align}
Then it may be possible to have two $Q$-barriers when the $Q$ profile
of the disc rises more rapidly (decays more slowly) than $R^{-3/2}$
for decreasing (increasing) $R$. One possibility is a gap
opened by a giant planet in a constant-$Q$ disc. In that case $Q$
rises rapidly towards the gap centre since it is a region of low
surface density.  %multi spirals associated with one planet 




%talk about additional simulations at high Q
%spiral mode as external potential to wider disc (lp11)
%interaction across co-rotation


\subsection{The confined spiral as an external potential}
One possible effect of self-gravity is to allow the one-armed spiral  
to act as an external potential for the wider disc. This is
analogous to disc-satellite interaction 
\citep{goldreich79}. Here, we estimate the magnitude of this effect
using basic results from disc-planet theory \citep[see, e.g.][and
references therein]{papaloizou07}.  

Let us treat the one-armed spiral confined in $R\in[R_1,R_2]$ as an  
external potential of the form $\Phi_\mathrm{ext}(R)\cos{\left(\phi -
    \Omega_pt\right)}$. We take 
\begin{align} 
  \Phi_\mathrm{ext}
  =-\frac{GM_\mathrm{ring}}{\overline{R}}b^{1}_{1/2}(\beta),   
\end{align}
where $M_\mathrm{ring}$ is the disc mass contained within
$R\in[R_1,R_2]$, $\overline{R} = (R_1+R_2)/2$ is the approximate radial
location of the spiral, $b_{n}^m(\beta)$ is the Laplace coefficient
and $\beta = R/\overline{R}$. This form of
$\Phi_\mathrm{ext}$ is the $m=1$ component of the gravitational
potential of an external satellite on a circular orbit
\citep{goldreich79}.    

%For an order-of-magnitude exercise, we simply take 
%\begin{align}
 % \Phi_\mathrm{ext} = -\frac{GM_\mathrm{ring}}{|R - \overline{R}|}, 
%\end{align}
%for the potential associated with a disturbance located at
%$R=\overline{R}$, where $M_\mathrm{ring}$ 

We expect the external potential to exert a torque on the disc at the
Lindblad and co-rotation resonances. At the outer Lindblad resonance
(OLR), this torque is 
\begin{align}
  \Gamma_L =
  \frac{\pi^2\Sigma_L}{3\Omega_L\Omega_p}
  \left[\left.R_L\frac{d\Phi_\mathrm{ext}}{dR}\right|_L + 2\left(1 -
      \frac{\Omega_p}{\Omega_L}\right)\Phi_\mathrm{ext}\right]^2, 
\end{align}   
where a Keplerian disc has been assumed and subscript $L$ denotes
evaluation at the OLR, $R=R_L$. (The inner Lindblad resonance does not
exist for the pattern speeds observed in our simulations.) 

If we associate the external potential with angular momentum 
$J_\mathrm{ext}  = M_\mathrm{ring}\overline{R}^2\Omega_p$, we can obtain a
rate $\gamma_L=\Gamma_L/J_\mathrm{ext}$. Then 
\begin{align}
  \frac{\gamma_L}{\Omega_p} = &\frac{\pi
    h}{3Q_L}\left(\frac{M_p}{M_*}\right)\left(\frac{R_L}{\overline{R}}\right)\left(\frac{R_c}{\overline{R}}\right) 
  ^3\left(\frac{R_L}{R_c}\right)^{-3/2}\notag\\ 
  &\times
  \left\{\frac{R_L}{\overline{R}}\left.\frac{db_{1/2}^1}{d\beta}\right|_L
    + 2\left[1 - 
      \left(\frac{R_c}{R_L}\right)^{-3/2}\right]b_{1/2}^1(\beta_L)\right\}^2. 
\end{align}
%\begin{align}
 % \frac{\gamma_L}{\Omega_p} \sim &\frac{\pi h}{3
  %  Q_L}\left(\frac{M_\mathrm{ring}}{M_*}\right)\left(\frac{R_L}{\overline{R}}\right)^{-1/2}\left(\frac{R_c}{\overline{R}}\right)^{5/2}\notag\\
 % &\times \left\{ \frac{R_L}{R_L - \overline{R}} - 2\left[1 -
  %    \left(\frac{R_c}{R_L}\right)^{-3/2}\right]\right\}^2\frac{R_c^2}{\left(R_L
   % - \overline{R}\right)^2}. 
%\end{align}
Inserting $h=0.05$, $Q_L=10$, $M_\mathrm{ring} = 0.05M_*$,
$R_L=7.2R_0$, $R_c=4.4R_0$ and $\overline{R}=1.5R_0$ from our fiducial
FARGO simulation, we get
\begin{align}
  \gamma_L \sim 5\times10^{-4}\Omega_p. 
\end{align}
%\begin{align}
 % \gamma_L \sim 0.012\Omega_p. 
%\end{align}
%This represents an upper limit on the effect of the OLR on the spiral
%disturbance, and is much smaller than the growth rate measured in the
%simulation ($\gamma\sim0.1\Omega_p$). We conclude that for our models,
%the OLR has negligible effect on the one-armed spiral.  
For the co-rotation torque, we use the result
\begin{align}
  \Gamma_c = \left.
    \pi^2\Phi_\mathrm{ext}^2\left(\frac{d\Omega}{dR}\right)^{-1}\frac{d}{dR}\left(\frac{2\Sigma}{\Omega}\right)\right|_{c}     
\end{align}
for a Keplerian disc, where subscript $c$ denotes evaluation at
co-rotation radius $R=R_c$. For a power-law surface density profile
$\Sigma\propto R^{-s}$ we have
\begin{align}
\frac{\gamma_c}{\Omega_p} = \frac{4}{3}\frac{\pi h}{Q_c}
\left(\frac{M_\mathrm{ring}}{M_*}\right)\left(\frac{R_c}{\overline{R}}\right)^4\left(s-\frac{3}{2}\right) 
\left[b_{1/2}^1(\beta_c)\right]^2    
\end{align}
%\begin{align}
%  \frac{\Gamma_C}{J_\mathrm{ext}\Omega_p} = \frac{4}{3}\frac{\pi h}{Q_C} \left(s -
 %   \frac{3}{2}\right)\left(\frac{M_\mathrm{ring}}{M_*}\right)\frac{R_c^4}{\overline{R}^2\left(R_c
 %     - \overline{R}\right)^2}.   
%\end{align}
Using the above parameter values with $s=2$ and $Q_c=10$, we obtain a
rate
\begin{align}
  \gamma_c\sim 6\times 10^{-4}\Omega_p. 
\end{align}

These estimates are much smaller than that due to
the imposed temperature gradient as measured in the simulations
($\gamma\sim 0.1\Omega_p$). We conclude that for our disc models, the
Lindblad and co-rotation resonances have negligible effect on the
growth of the spiral arm in the inner disc. We confirmed this with
additional FARGO simulations with a reduced radial domain size,
setting $R_\mathrm{max}=3R_0$, which still developed the one-armed
spiral. 

The torque exerted on the disc at the OLR by an
external potential is positive, while that at co-rotation 
depends on the gradient of potential vorticity there
\citep{goldreich79}. For our disc models with surface density
$\Sigma\propto R^{-2}$ in the outer disc, this co-rotation torque is
positive. Interpreting the one-armed spiral as an external potential
for the outer disc, this means that the spiral loses
angular momentum by launching density waves with positive angular momentum at
the OLR, and by applying a positive co-rotation torque on the disc. In
principle, this interaction is destabilising because the one-armed
spiral has negative angular momentum \citep{lin11b}. As estimated
above, this effect is small in our simulations, but could be
important for other parameter regimes. 

%also transport ang mom outwards
