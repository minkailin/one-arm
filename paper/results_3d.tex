\section{Three-dimensional simulations}\label{results3d}
In this section we review 3D simulations carried 
out using ZEUS-MP and PLUTO. The main purpose is to verify 
the above results with different numerical codes, and validate  
the 2D approximation.    

The 3D disc has radial size
$[r_\mathrm{min},r_\mathrm{max}]=[0.4,10]R_0$ and vertical extent  
$n_H=2$ scale-heights at $R=R_0$. The resolution is $N_r\times N_\theta\times
N_\phi=256\times32\times256$. This corresponds to about $4$ cells per
$H$in radius. Because of the much reduced resolution 
compared to 2D, we use a smooth perturbation by setting
$\delta = 10^{-3}$ and $M=1$ in Eq. \ref{randpert}. This corresponds
to a single $m=1$ disturbance in $R\in[R_1,R_2]$, which was found to dominate
the 2D simulation.  

The 3D discs are initialised in approximate equilibrium only, so we
first evolve the disc without perturbations using  
$(\lmax,\mmax)=(32,0)$ up to $t=10P_0$, during which 
meridional velocities are damped out. We then restart the simulation
with the above perturbation and $(\lmax,\mmax)=(32,32)$ and damp
merdional velocities near the radial boundaries. 

Fig. \ref{3d_ampmax} plots the amplitude of the $m=1$ spirals measured
in the ZEUS-MP and PLUTO runs. We also show results from strictly
isothermal discs ($q=0$), which clearly display no growth. %why no high m
                                %modes as in 2D for iso disc?
                                %resolution?
The mode amplitude from ZEUS-MP appears to be off-set from that obtained using
PLUTO. We suspect this may be due to larger numerical noise in the
ZEUS-MP code. Thus the $m=1$ spiral grows to a larger amplitude by the
end of the run. However, we measure similar growth rates,
\begin{align*}
  &\gamma \simeq 0.0073\Omega_k(R_0) \quad\quad \mathrm{PLUTO},\\
  &\gamma \simeq 0.0084\Omega_k(R_0) \quad\quad \varA{ZEUS-MP}.
\end{align*}
Both are smaller than the 2D simulations above. This may be due to the
low resolutions adopted and or the small softening length employed in
2D.  
%growth rate does not depend on pert amp

\begin{figure}
  \includegraphics[width=\linewidth]{figures/m1_analysis_plot_ampmax3d.ps}
  \caption{Evolution of the maximum $m=1$ density in  $r\in[R_1,R_2]$
    measured in the 3D simulations. Both discs with a imposed
    temperature gradient ($q=1$) and a strictly isothermal disc
    ($q=0$) are shown.  
    \label{3d_ampmax}}   
\end{figure}

Visualisations of the 3D simluations are shown in   
Fig. \ref{3d_prelim} for the disc midplane and near the upper disc
boundary. The snapshots are chosen when the spirals in the two codes
have reached similar amplitudes. %The agreement between the codes,
% as well as with the 2D simulations, is satisfactory.    
Away from the disc midplane, a coherent spiral arm is
not prominent, but the disturbance is radially more global, extending
up to $R\sim 4R_0$. %implications?

\begin{figure}
  \begin{center}
    \subfigure[ZEUS-MP]{
      \includegraphics[scale=0.382]{figures/polarxy_dens015_z0}
      \includegraphics[scale=0.382,clip=true,trim=2.24cm 0cm 0cm
      0cm]{figures/polarxy_dens015_zmax}  
    }
    \subfigure[PLUTO]{
      \includegraphics[scale=0.382]{figures/pdisk_020_z0}
      \includegraphics[scale=0.382,clip=true,trim=2.24cm 0cm 0cm
      0cm]{figures/pdisk_020_zmax}
    }
  \end{center}
  \caption{Three-dimensional simulations using the ZEUS-MP (top) and 
    PLUTO (bottom) codes. The non-axisymmetric density at the midplane (left) and
    two scale-heights above the midplane (right) is shown. Here $\psi
    \equiv \pi/2 - \theta$ is the angular height  
    from the midplane.\label{3d_prelim}}   
\end{figure}

\subsection{Vertical structure}
Fig. \ref{3d_rz} shows the vertical structure of the one-arm
spiral in the PLUTO run. The main spiral is confined to $z < H$.
However, outside $R>2R_0$ we observe spirals   

\begin{figure}
  \includegraphics[scale=0.47,clip=true,trim=0cm 0.79cm 0cm 0cm]{figures/pdisk_rz_020_sg.ps}
  \includegraphics[scale=0.47,clip=true,trim=0cm 0cm 0cm 0.64cm]{figures/pdisk_rz_020_nsg.ps}
  \caption{Non-axisymmetric density in the meridional plane from the
    PLUTO simulation. The slices are taken at the azimuth of   
    $\mathrm{max}[\Delta\rho(r,\pi/2,\phi)]$. Arrows correspond to the vector 
    $(v_r/R_0,-v_\theta/rh\sin^2{\theta})$. The top (bottom) panel corresponds
    to the inner (outer) portions of the disc. 
    \label{3d_rz}} 
\end{figure}   

We measure three-dimensionality using the parameter $\Theta$ as
defined in Eq. \ref{theta}.  Vertical velocities
do increase with the growth of the one-arm spiral, 
%Larger amplitudes
%are reached in ZEUS because of larger numerical noise. 
but we find  $\Theta \lesssim 10^{-2}$. This implies $|v_z/c_s|\lesssim
0.2$ for $h=0.05$. Thus, vertical motions are sub-sonic and negligible
compared to horizontal motions. This supports the 2D approximation. 

%\begin{figure}
%  \includegraphics[width=\linewidth]{figures/m1_analysis_plot_vert.ps}
% \caption{Evolution of three-dimensionality $\Theta$, as defined by
%    Eq. \ref{theta}, which corresponds to the
%   average vertical kinetic energy density, scaled by 
%    the average horizontal kinetic energy.\label{3d_vert}} 
%\end{figure}   

\subsection{Angular momentum evolution}

Fig. \ref{3d_angmom} shows the angular momentum evolution in the 3D
runs. ZEUS-MP does not conserve angular momentum very well, but
the variation $|\Delta J/J|< O(10^{-6})$ is not significant compared
to the individual components $|\Delta J_{0,1}/J|\sim 
5\times10^{-5}$. The PLUTO run reaches similar values of
$|J_{0,1}|$, but achieves better conervation, with $|\Delta
J/J|=O(10^{-8})$. 

\begin{figure}
%scale=0.41
  \includegraphics[scale=.41,clip=true,trim=0cm 1cm 0cm 0cm]{figures/nonaxi_evol_ang_zeus}
  \includegraphics[scale=.41]{figures/nonaxi_evol_ang_pluto}
  \caption{Evolution of angular momentum components in the 3D 
    simulations. The perturbation 
    relative to $t=100P_0$, during the growth of the one-arm spiral,
    is shown in units of the initial total angular momentum
    $J_\mathrm{ref}$.\label{3d_angmom}}  
\end{figure}   

